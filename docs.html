<!DOCTYPE html><html dir="ltr" lang="en"><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width,initial-scale=1,user-scalable=no,minimum-scale=1,maximum-scale=1" name="viewport"><title>Docs - @squirrel-forge/twighouse</title><meta name="description" content="A simple, but extendable, json+twig render tool for node"><style type="text/css">:root{--theme-color-a:lightseagreen;--theme-color-b:tomato;--theme-contrast-a:whitesmoke;--theme-contrast-b:black;--theme-dark-a:darkslateblue;--theme-dark-b:darkslategrey}*{box-sizing:border-box}html{font-family:monospace;font-size:16px;line-height:1.2;scroll-behavior:smooth;scroll-padding-top:3.2rem}a{display:inline-block}a span{display:inline-block;text-decoration:inherit}body{margin:0;padding:0;color:var(--theme-contrast-b)}main{padding:1rem 0}aside{z-index:1;position:fixed;padding:1rem .5rem 1rem 1rem;top:3.2rem;right:0;max-height:calc(100% - 7.4rem);display:flex;flex-direction:column;background:var(--theme-contrast-a);transition:.2s ease}aside::before{position:absolute;top:.75rem;left:0;width:0;height:0;border-top:1rem solid transparent;border-bottom:1rem solid transparent;border-right:1rem solid var(--theme-contrast-a);transform:translateX(-1rem);content:''}aside div{padding-right:.5rem;width:calc(100% + .5rem);flex-grow:1;overflow:auto}header{z-index:2;background:var(--theme-color-a)}footer{margin-bottom:1rem;background:var(--theme-color-b)}footer,header{width:100%;color:var(--theme-contrast-a)}footer>div,header>div{display:flex}footer>div,header>div,section>div{margin:auto;padding:0 1rem;width:100%;max-width:min(calc(100% - 4rem),980px)}section>div{padding:0 1.5rem}footer>div>span,header>div>a{margin:auto auto auto 0;padding:.5rem;font-weight:700}footer a,footer a:visited,header a,header a:visited{display:inline-block;padding:.5rem;color:inherit;background-color:transparent;opacity:1;transition:.2s ease}header a:focus,header a:hover,header a[data-active=true]{background:var(--theme-dark-a)}footer a:focus,footer a:hover,footer a[data-active=true]{background:var(--theme-dark-b)}footer nav,header nav{margin:auto 0 auto auto}nav ul{list-style:none;margin:0;padding:0;display:flex;flex-direction:row}nav li{display:block;margin:.2rem;padding:0}nav li[data-indent]{padding-left:1rem}aside nav ul{flex-direction:column}main li+li{margin-top:1.5rem}main aside li+li{margin-top:.5rem;margin-left:0}main a{font-weight:700;color:var(--theme-dark-a);transition:.2s ease}main a[target="_blank"]::after{top:-.25rem;margin-left:0}main a:visited{color:var(--theme-dark-b)}main a:focus,main a:hover{color:var(--theme-dark-b)}a[target="_blank"]{position:relative}a[target="_blank"] span{padding-right:.5rem}a[target="_blank"]::after{position:absolute;top:.15rem;margin-left:-.5rem;text-decoration:none;content:'\2197'}aside nav a{text-decoration:none}aside nav a:focus,aside nav a:hover{text-decoration:underline}h1:first-child,h2:first-child,h3:first-child,h4:first-child{margin-top:0}aside h3,h1{color:var(--theme-color-b)}h2,h3,h4{color:var(--theme-color-a)}hr{border-color:var(--theme-color-b)}small{font-size:80%;line-height:inherit}pre{display:block;margin:0}code{display:block;margin:1rem 0;padding:1rem;white-space:pre-wrap;color:var(--theme-dark-a);background:var(--theme-contrast-a);overflow-x:scroll}table{display:block;border-spacing:.2rem;max-width:100%;overflow-x:scroll}td,th{padding:.5rem;vertical-align:top}th{font-weight:700}thead tr,tr:nth-child(even){color:var(--theme-dark-a);background:var(--theme-contrast-a)}tbody tr:nth-child(odd){color:var(--theme-dark-b)}td:nth-child(1),td:nth-child(2),td:nth-child(3){white-space:nowrap;text-align:center}@media screen and (min-width:768px){header{position:fixed;top:0;left:0}main{padding:4rem 0;min-height:calc(100vh - 4.4rem);overflow-x:hidden}}@media screen and (max-width:1300px){aside{transform:translateX(calc(100% - 1rem));filter:drop-shadow(0 0 .1rem var(--theme-contrast-b))}aside:focus,aside:focus-within,aside:hover{transform:translateX(0)}}@media screen and (max-width:767px){html{scroll-padding-top:8rem}footer,header{padding:.5rem 0}footer nav,header nav{margin:0}footer>div,header>div{flex-direction:column}footer>div,header>div,section>div{padding:0;max-width:calc(100% - 2rem)}footer a,header a{width:100%}th:last-child{min-width:60vw}aside{top:8rem;max-height:calc(100% - 15.8rem)}}@media screen and (max-width:320px){th:last-child{min-width:calc(80vw - 2rem)}}</style></head><body data-debug="true"><a id="top"></a><header><div><a href="index.html"><span>@squirrel-forge/twighouse</span></a><nav><ul><li><a href="docs.html" data-active="true"><span>docs</span></a></li><li><a href="changelog.html"><span>changes</span></a></li><li><a href="https://github.com/squirrel-forge/node-twighouse" target="_blank"><span>github</span></a></li><li><a href="https://www.npmjs.com/package/@squirrel-forge/twighouse" target="_blank"><span>npm</span></a></li></ul></nav></div></header><main id="content" class="content"><aside tabindex="0"><div><h3>Overview</h3><p>&#x21E7;<a href="#top">top</a></p><nav><ul><li><a href="#installation"><span>Installation</span></a></li><li data-indent="1"><a href="#quickstart"><span>Quickstart</span></a></li><li><a href="#cli-usage"><span>cli usage</span></a></li><li data-indent="1"><a href="#arguments"><span>Arguments</span></a></li><li data-indent="1"><a href="#options"><span>Options</span></a></li><li><a href="#json-input"><span>JSON input</span></a></li><li data-indent="1"><a href="#special-properties"><span>Properties</span></a></li><li data-indent="1"><a href="#fragments"><span>Fragments</span></a></li><li data-indent="1"><a href="#directives"><span>Directives</span></a></li><li><a href="#templates"><span>Templates</span></a></li><li data-indent="1"><a href="#loading-templates"><span>Loading</span></a></li><li><a href="#plugins"><span>Plugins</span></a></li><li data-indent="1"><a href="#methods"><span>Methods</span></a></li><li data-indent="1"><a href="#adding-directives"><span>Directives</span></a></li><li><a href="#api-usage"><span>Api usage</span></a></li><li data-indent="1"><a href="#setting-arguments-and-options"><span>Args &amp; Opts</span></a></li><li data-indent="1"><a href="#adding-plugin-methods"><span>Plugins</span></a></li><li data-indent="1"><a href="#adding-directives"><span>Directives</span></a></li></ul></nav></div></aside><section><div><h1 id="squirrel-forgetwighouse">@squirrel-forge/twighouse</h1><p>A simple, but extendable, json+twig render tool for node.</p><h2 id="installation">Installation</h2><pre><code>npm i @squirrel-forge/twighouse -g</code></pre><h3 id="quickstart">Quickstart</h3><p>To see a working example run following commands inside an empty directory. The example uses directives and the showdown module to render this README.md to html. For the example you must install showdown yourself, it is neither needed nor required for twighouse itself.</p><pre><code>npm i showdown@1.9.1</code></pre><p>Then run the commands to deploy the example and render it.</p><pre><code>twighouse example -x
twighouse example dist</code></pre><p>You will find the compiled files inside the dist directory and the example source data inside the example directory.</p><h2 id="cli-usage">cli usage</h2><pre><code>twighouse target --boolean --path=../dir --str=about --str=index,about
twighouse source target --boolean --path=../dir --str=about --str=index,about</code></pre><h3 id="arguments">Arguments</h3><h4 id="using-only-one-argument">Using only one argument</h4><p>the source argument is omitted and assumed to be the current working directory</p><ol><li>target - Path to write compiled html pages</li></ol><h4 id="using-two-arguments">Using two arguments</h4><ol><li>source - Path from where to read <em>data/</em> and <em>templates/</em></li><li>target - Path to write compiled html pages</li></ol><h3 id="options">Options</h3><table><thead><tr><th>Short</th><th>Long</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>-d</td><td>--data</td><td>path</td><td>Overrides the source path argument for the data folder</td></tr><tr><td>-t</td><td>--templates</td><td>path</td><td>Overrides the source path argument for the templates folder</td></tr><tr><td>-l</td><td>--limit</td><td>str, ..</td><td>Limit which page or pages should be compiled</td></tr><tr><td>-m</td><td>--minify</td><td>bool</td><td>Minifies the html output</td></tr><tr><td>-o</td><td>--only</td><td>bool</td><td>Show compiled pages json only</td></tr><tr><td>-v</td><td>--verbose</td><td>bool</td><td>Show additional info</td></tr><tr><td>-x</td><td>--example</td><td>bool</td><td>Deploy example data and templates, accepts only one, the target, argument</td></tr></tbody></table><h2 id="json-input">JSON input</h2><p>The individual pages json is loaded from the <em>{source}/data/</em> directory, which has two special directories which are not read as part of the structure. The <a href="#fragments"><strong>fragments</strong></a> are loaded at runtime by reference in your json files and any js files in the <a href="#plugins">plugins</a> directory are executed right after the pages source tree was loaded.</p><p>Assume following data structure from the example build:</p><pre><code>[example]
 |
 +-- [data]
      |
      +-- [__fragments]
      |    | 
      |    |-- footer.json
      |    |-- header.json
      |    |-- meta.json
      |    `-- styles.json
      |
      +-- [__plugins]
      |    `-- example.js
      |
      |-- changelog.json
      |-- docs.json
      `-- index.json</code></pre><h3 id="special-properties">Special properties</h3><p>In general you will define what you need, there are only two special properties that can be used:</p><ul><li>The <em>__template</em> property is described <a href="#loading-templates">here</a> and must be on the root object.</li></ul><pre><code>{
  "__template": "{.../}template"
}</code></pre><ul><li>The <em>document</em> property gets defined before json processing and is set afterwards and may be modified via the <a href="#modify-data">modify_data</a> plugin method. Note that the document data object is supplied to any <a href="#directives">directives</a> running during processing.</li></ul><pre><code>{
  path: {string} The page reference, includes a full relativ path and the page slug
  dir: {string} The relative path of this page
  slug: {string} The page slug
  uri: {string} The generated page uri
}</code></pre><h3 id="fragments">Fragments</h3><p>Fragments work similar to fragements in graphql, though here we require valid json syntax, to include a fragment supply the relative path <em>string</em> to the object as property <em>__fragment</em> that should receive the fragments properties. Any properties already set will <em>not be overridden</em> by the fragment, consider the fragment to be the default data, there can be only one fragment defined per object, but a fragment itself may have a fragment defined in its root which will be processed recursivly.</p><p><code>{"__fragment": "{.../}fragment", ...overrides}</code></p><p>For explicit examples check the example source.</p><h3 id="directives">Directives</h3><p>Directives can modify properties and objects in the defined context of your pages json data, directives can be defined by <a href="#adding-directives">adding directives</a> via a <a href="#plugins">plugin</a> or the <a href="#api-usage">api</a> and can be used as following:</p><pre><code>{
  "__directives": ["directive_method_name:property_to_use", ...],
  "property_to_use": "*",
  ...
}</code></pre><p>Directives are always executed in the defined order, which lets you chain them to modify in steps</p><h2 id="templates">Templates</h2><p>The templates structure is all yours, following the default loading pattern, which can be modified via the <a href="#modify-template">modify_template</a> method with a <a href="#plugins">plugin</a> to load whatever you like.</p><p>Following the example structure:</p><pre><code>[example]
 |
 +-- [templates]
      |
      +-- [abstract]
      |    |
      |    |-- component.twig
      |    |-- content.twig
      |    `-- layout.twig
      |
      +-- [components]
      |    |
      |    |-- nav.twig
      |    |-- raw.twig
      |    `-- section.twig
      |
      +-- [partials]
      |    |
      |    |-- footer.twig
      |    |-- header.twig
      |    |-- meta.twig
      |    `-- styles.twig
      |
      `-- __page.twig</code></pre><h3 id="loading-templates">Loading templates</h3><p>Each page can have a <em>__template</em> property defined on the root, this should, but does not have to be a <em>relative path</em> from the source template directory, excluding the <em>.twig</em> extension, which can be changed via the <a href="#api-usage">api</a></p><p>Possible page templates when using defaults, for page reference <em>{…/}index</em> with slug <em>index</em>:</p><ul><li>The <strong>custom template</strong> defined on the page data root. <code>{source}/templates/{data.__template}.twig</code></li><li>The <strong>individual template</strong> by reference <code>{source}/templates/{.../}index.twig</code></li><li>The <strong>global template</strong> fallback, when none of the above can be resolved <code>{source}/templates/__page.twig</code></li></ul><h2 id="plugins">Plugins</h2><p>…</p><h3 id="methods">Methods</h3><p>…</p><h4 id="modify-twig">Modify twig</h4><p>…</p><h4 id="modify-data">Modify data</h4><p>…</p><h4 id="modify-template">Modify template</h4><p>…</p><h4 id="modify-html">Modify html</h4><p>…</p><h3 id="adding-directives">Adding directives</h3><p>…</p><h2 id="api-usage">Api usage</h2><p>You can require the TwigHouse class in your node script and run it, change internal options and extend it.</p><pre><code>const TwigHouse = require('@squirrel-forge/twighouse');
const twigH = new TwigHouse( ['example','-x'] );
twigH.verbose = false;
twigH.minify_options.removeComments = true;
twigH.magic_page = '__page';
const exit_code = await twigH.run();</code></pre><h3 id="setting-arguments-and-options">Setting arguments and options</h3><p>…</p><h3 id="adding-plugin-methods">Adding plugin methods</h3><p>…</p><h3 id="adding-directives-1">Adding directives</h3><p>…</p></div></section><section><div><h1 id="mit-license">MIT License</h1><p>Copyright (c) 2021 squirrel-forge</p><p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p><p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p><p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p></div></section><section><div><hr><p><small>This page was generated using <a href="https://github.com/squirrel-forge/node-twighouse#readme" target="_blank">@squirrel-forge/twighouse@0.3.0</a></small></p></div></section></main><footer><div><span>&copy; 2021 @squirrel-forge</span><nav><ul><li><a href="https://github.com/squirrel-forge" target="_blank"><span>@github</span></a></li><li><a href="https://www.npmjs.com/org/squirrel-forge" target="_blank"><span>@npm</span></a></li></ul></nav></div></footer><script type="text/javascript"></script></body></html>